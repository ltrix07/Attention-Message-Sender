# Attention Message Sender
## –û–ø–∏—Å–∞–Ω–∏–µ
–°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ –æ—Ä–¥–µ—Ä–∞–º –≤ —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–æ–¥–∞–∂.
–°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Google API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ Google Sheets, –∞ —Ç–∞–∫ –∂–µ Telegram API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ 
–≤ —Ä–∞–±–æ—á–∏–µ —á–∞—Ç—ã.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. `git clone https://github.com/ltrix07/Attention-Message-Sender.git`
2. `python3 -m venv venv`
3. `source venv/bin/activate`
4. `pip3 install -r requirements.txt`
5. –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `creds`:
   1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `google_creds.json`. –í –Ω–µ–º –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–ª—é—á –æ—Ç —Å–µ—Ä–≤–∏—Å–Ω–æ–π –ø–æ—á—Ç—ã Google.
   2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `telegram.json`. –í –Ω–µ–º –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–∫–µ–Ω –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–ª–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è. –§–æ—Ä–º–∞—Ç —Ç–∞–∫–æ–π:  
```json
{
  "token": "<token>"
}
```
6. –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `db`:
   1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `chat_data.json`. –í –Ω–µ–º –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—Å—è id —Ç–µ—Ö —á–∞—Ç–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–æ–≥–æ –∏–ª–∏
–∏–Ω–æ–≥–æ —Ç–∏–ø–∞.
   2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `spreadsheets.json`. –í –Ω–µ–≥–æ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Å—è –∏—Ñ–Ω–æ—Ä–º–∞—Ü–∏—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ —Ñ–∞–π–ª [maneger.py](maneger.py)
   3. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `staff.json`. –í –Ω–µ–º –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∏–∫–Ω–µ–π–º—ã —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º.  
7. `python3 maneger.py`. –î–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ —Ç–∞–±–ª–∏—Ü—ã (–±—É–¥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å—Å—è —Ü–∏–∫–ª–æ–º).  
8. `python3 main.py`  

–í–∏–¥ —Ñ–∞–π–ª–∞ `chat_data.json`:
```json
{
  "chat_w_problems": "id —á–∞—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è —Å –æ—à–∏–±–∫–æ–π",
  "chat_w_attentions": "id —á–∞—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ"
}
```

–í–∏–¥ —Ñ–∞–π–ª–∞ `spreadsheets.json` (–±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ–ª—É–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):
```json
{
  "test": {
    "table_id": "<table_id>",
    "columns": {
      "status1": "Status 1",
      "purchase_date": "Date of purchase",
      "profit_amount": "Profit with gift",
      "perc_profit": "Profit (%)",
      "perc_w_gift": "Profit with gift %",
      "order_num": "Order ID Amazon",
      "buy_price": "Buy price"
    }
  }
}
```

–í–∏–¥ —Ñ–∞–π–ª–∞ `staff.json`:
```json
{
  "analysts": ["@worker1", "@worker2"],
  "buyers": ["@worker1", "@worker2"],
  "developers": ["@worker1", "@worker2"],
  "trackers": ["@worker1", "@worker2"]
}
```


## –ê–ª–≥–æ—Ä–∏—Ç–º
–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–µ–π—Å—Ç–≤–∏–π:
1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—Å–µ –Ω—É–∂–Ω—ã–µ –µ–º—É –¥–ª—è —Ä–∞–±–æ—Ç—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∞. –ó–∞ —ç—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è [main()](https://github.com/ltrix07/Attention-Message-Sender/blob/0db497da31a28a04e1d15c4ece5224c244f05794/main.py#L75).
2. –ß–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø–∏—Å–∞–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ —á–∞—Ç—ã –∏ —Ç–∞–±–ª–∏—Ü—ã. –§—É–Ω–∫—Ü–∏—è [process()](https://github.com/ltrix07/Attention-Message-Sender/blob/0db497da31a28a04e1d15c4ece5224c244f05794/main.py#L57).  
–ß—Ç–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑ –¥–≤—É—Ö —Ñ–∞–π–ª–æ–≤ - `creds/telegram.json` (—á–∞—Ç—ã —Ç–µ–ª–µ–≥—Ä–∞–º, –≤ –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è) –∏ `db/spreadsheets.json`
   (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ —Ç–∞–±–ª–∏—Ü—ã, —Å –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–¥–æ –ø–æ–ª—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é).
3. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü—ã —Ü–µ–ª–∏–∫–æ–º –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∫–∏–µ –ª–∏—Å—Ç—ã –µ—Å—Ç—å, –∫–∞–∫–∏—Ö –Ω–µ—Ç. –ó–∞ —ç—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è [look_table()](https://github.com/ltrix07/Attention-Message-Sender/blob/0db497da31a28a04e1d15c4ece5224c244f05794/main.py#L29).
–ï—Å–ª–∏ –Ω–µ—Ç –ª–∏—Å—Ç–∞ —Å —Ç–µ–∫—É—â–∏–º –º–µ—Å—è—Ü–µ–º, –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç [—Å–æ–æ–±—â–µ–Ω–∏–µ](https://github.com/ltrix07/Attention-Message-Sender/blob/840f787bd82c2fbfc3b26b448a745532535a1c8c/README.md#L86).
_–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Å—Ç–æ–∏—Ç –Ω–∞–∑—ã–≤–∞—Ç—å –ª–∏—Å—Ç—ã –Ω–æ–º–µ—Ä–∞–º–∏ –º–µ—Å—è—Ü–µ–≤_.
4. –ë–æ—Ç –ø—Ä–∏—Å—Ç—É–ø–∞–µ—Ç –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–≥–æ –ª–∏—Å—Ç–∞ (—Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü, –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü, –∞–∑–∞—Ç —Ç–µ–∫—É—â–∏–π –º., –∞–∑–∞—Ç –ø—Ä–æ—à–ª—ã–π –º.  
5. –±—Ä–æ —Ç–µ–∫—É—â–∏–π –º., –±—Ä–æ –ø—Ä–æ—à–ª—ã–π –º.). –ó–∞ —ç—Ç—É –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Ç–≤–µ—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è [sheet_look()](https://github.com/ltrix07/Attention-Message-Sender/blob/0db497da31a28a04e1d15c4ece5224c244f05794/main.py#L16).  
6. –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å –ª–∏—Å—Ç–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–µ—Ç–æ–¥–∞ [get_all_info_from_sheet()](https://github.com/ltrix07/Attention-Message-Sender/blob/0db497da31a28a04e1d15c4ece5224c244f05794/main.py#L22).  
7. –û–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∏–Ω–¥–µ–∫—Å—ã —Ç–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–º –Ω—É–∂–Ω–∞. –ü—Ä–∏ –ø–æ–º–æ—â–∏ –º–µ—Ç–æ–¥–∞ [get_columns_indices()](https://github.com/ltrix07/Attention-Message-Sender/blob/0db497da31a28a04e1d15c4ece5224c244f05794/main.py#L23).  
8. –û–±—â–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∏–Ω–¥–µ–∫—Å–æ–≤. –ü—Ä–∏ –ø–æ–º–æ—â–∏ –º–µ—Ç–æ–¥–∞ [filter_data_by_indices()](https://github.com/ltrix07/Attention-Message-Sender/blob/0db497da31a28a04e1d15c4ece5224c244f05794/attention_sender/inspections.py#L22).  


## –í–∏–¥—ã —Å–æ–æ–±—â–µ–Ω–∏–π
### NoWorksheetInTable
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –±–æ—Ç–æ–º –≤ —Ç–æ–º —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –æ–Ω –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –ª–∏—Å—Ç –Ω–∞–∑–≤–∞–Ω—ã–π **—Ç–µ–∫—É—â–∏–º** –º–µ—Å—è—Ü–µ–º.
```text
@worker1, worker2
–í —Ç–∞–±–ª–∏—Ü–µ "10" –Ω–µ—Ç –ª–∏—Å—Ç–∞ —Å —Ç–µ–∫—É—â–∏–º –º–µ—Å—è—Ü–µ–º.
```
–ü–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –±—É–¥–µ—Ç –∫–Ω–æ–ø–∫–∞ `–Ø –¥–æ–±–∞–≤–∏–ª –ª–∏—Å—Ç`. –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Ä–∞–±–æ—Ç–Ω–∏–∫ —Å–æ–∑–¥–∞–ª –ª–∏—Å—Ç –∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ —É–∫–∞–∑–∞–ª —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –æ–Ω –¥–æ–ª–∂–µ–Ω
–Ω–∞–∂–∞—Ç—å —ç—Ç—É –∫–Ω–æ–ø–∫—É. –≠—Ç–æ –¥–∞—Å—Ç –±–æ—Ç—É –ø–æ–Ω—è—Ç—å —á—Ç–æ —á–µ–ª–æ–≤–µ–∫ –∏—Å–ø—Ä–∞–≤–∏–ª –æ—à–∏–±–∫—É –∏ –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –æ–Ω –≤—Å—Ç—Ä–µ—Ç–∏—Ç –µ–µ —Å–Ω–æ–≤–∞, —Ç–æ –Ω—É–∂–Ω–æ –æ–ø—è—Ç—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —á–∞—Ç.  

### BadPrice
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ç–æ–º —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —Ü–µ–Ω–∞ `perc_w_gift` (–ø—Ä–∏–±—ã–ª—å —Å –≥–∏—Ñ—Ç–æ–π –≤ %) –º–µ–Ω–µ–µ –º–µ–Ω—å—à–µ -7%.
```text
‚ùóÔ∏èWarning: –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –º–∏–Ω—É—Å.
Amazon order: 111-1111-1111-111
Profit ($): -10$
Profit (%): -8%
Shop: "Test"
Sheet name: "7"
```
–í —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —Ü–µ–Ω—É –∏—Å–ø—Ä–∞–≤—è—Ç –∏ –ø—Ä–∏–±—ã–ª—å —Å –≥–∏—Ñ—Ç–æ–π —Å—Ç–∞–Ω–µ—Ç –±–æ–ª–µ–µ -7%, –±–æ—Ç —É–¥–∞–ª–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –≥—Ä—É–ø–ø—ã –∏ –∏–∑ —Å–≤–æ–µ–π –ë–î.

### AttentionMessage
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ —Å—Ç–∞–≤–∏—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã–π —Å—Ç–∞—Ç—É—Å.
```text
{workers}
‚ùóÔ∏è{status}

{order}

üìÖ{buy_date}
üë®‚Äçüíª{worker_type}
üè™{shop_name}
üìÅ{sheet_name}
```
* _workers_ - –æ—Ç–º–µ—Ç–∏—Ç —Ç–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–º –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.
* _status_ - —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã–π —Å—Ç–∞—Ç—É—Å.
* _order_ - –Ω–æ–º–µ—Ä –æ—Ä–¥–µ—Ä–∞ –∞–º–∞–∑–æ–Ω.
* _buy_date_ - –¥–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ —Ç–æ–≤–∞—Ä–∞.
* _worker_type_ - —Ç–∏–ø (—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è) —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä–æ–º—É –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.
* _shop_name_ - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞, –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.
* _sheet_name_ - –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞, –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.
#### –¢—Ä–∏–≥–≥–µ—Ä–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã
* **–°—Ä–æ—á–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞** - –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è –∫ `analysts`.
* **–°—Ä–æ—á–Ω–æ —Ç—Ä–µ–±.–∑–∞–∫—É–ø** - –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ `buyers`.
* **–¢—Ä–µ–±.–∑–∞–∫—É–ø –Ω–æ–≤—ã–π –ø–æ—Å—Ç–∞–≤—â–∏–∫** - –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ `buyers`.
* **–û—Ç–º–µ–Ω–∞** - –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ `trackers`.